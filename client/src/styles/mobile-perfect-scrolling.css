/* ==========================================
   MOBILE PERFECT SCROLLING - УНІВЕРСАЛЬНЕ РІШЕННЯ
   Повний скролінг для всіх мобільних пристроїв
   ========================================== */

@media (max-width: 1023px) {

  /* ==========================================
     БАЗОВА СТРУКТУРА VIEWPORT
     ========================================== */

  html {
    height: 100%;
    min-height: 100vh;
    width: 100% !important;
  }

  body {
    height: 100%;
    min-height: 100vh;
    width: 100% !important;
    margin: 0 !important;
    padding: 0 !important;
    overscroll-behavior-y: contain !important;
    -webkit-overflow-scrolling: touch !important;
  }

  #root {
    min-height: 100vh;
    width: 100%;
    display: flex;
    flex-direction: column;
  }

  /* ==========================================
     ГОЛОВНИЙ КОНТЕЙНЕР ДОДАТКУ
     ========================================== */

  .App,
  .app,
  [class*="app"] {
    flex: 1 1 auto;
    display: flex;
    flex-direction: column;
    min-height: 0;
  }

  /* ==========================================
     LAYOUT КОНТЕЙНЕРИ
     ========================================== */

  /* Головний wrapper */
  .min-h-screen {
    min-height: 100vh !important;
    display: flex !important;
    flex-direction: column !important;
  }

  /* Main content area */
  main,
  .main,
  [role="main"] {
    flex: 1 1 auto;
    min-height: 0 !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;
    overscroll-behavior-y: contain !important;
    padding-bottom: 80px !important; /* Для bottom navigation */
    padding-bottom: calc(80px + env(safe-area-inset-bottom, 0)) !important;
  }

  /* ==========================================
     FLEX КОНТЕЙНЕРИ - КРИТИЧНО
     ВИКЛЮЧЕННЯ: messenger (має власний viewport)
     ========================================== */

  .flex:not(.messenger-mobile-container):not(.messenger-mobile-container *) {
    min-height: 0 !important;
  }

  .flex-col:not(.messenger-mobile-container):not(.messenger-mobile-container *) {
    min-height: 0 !important;
  }

  .flex-1:not(.messenger-mobile-container):not(.messenger-mobile-container *) {
    flex: 1 1 0% !important;
    min-height: 0 !important;
  }

  .flex-auto:not(.messenger-mobile-container):not(.messenger-mobile-container *) {
    flex: 1 1 auto !important;
    min-height: 0 !important;
  }

  .flex-grow:not(.messenger-mobile-container):not(.messenger-mobile-container *) {
    flex-grow: 1 !important;
    min-height: 0 !important;
  }

  /* ==========================================
     OVERFLOW КОНТЕЙНЕРИ
     ВИКЛЮЧЕННЯ: messenger (має власний viewport)
     ========================================== */

  .overflow-y-auto:not(.messenger-mobile-container):not(.messenger-mobile-container *),
  .overflow-y-scroll:not(.messenger-mobile-container):not(.messenger-mobile-container *),
  .overflow-auto:not(.messenger-mobile-container):not(.messenger-mobile-container *),
  [class*="overflow-y-auto"]:not(.messenger-mobile-container):not(.messenger-mobile-container *),
  [class*="overflow-y-scroll"]:not(.messenger-mobile-container):not(.messenger-mobile-container *) {
    flex: 1 1 0% !important;
    min-height: 0 !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;
    overscroll-behavior-y: contain !important;
    scroll-behavior: smooth;
  }

  /* ==========================================
     DASHBOARD І ÜBERSICHT СТОРІНКА
     ========================================== */

  .dashboard-container,
  .ubersicht-container,
  [class*="dashboard"],
  [class*="overview"] {
    flex: 1 1 auto;
    min-height: 0 !important;
    display: flex;
    flex-direction: column;
    overflow: hidden !important;
  }

  .dashboard-content,
  .ubersicht-content,
  .page-content {
    flex: 1 1 auto;
    min-height: 0 !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;
    padding-bottom: 100px !important;
  }

  /* ==========================================
     КАЛЕНДАР - SCROLLABLE
     ========================================== */

  .calendar-wrapper,
  .calendar-container,
  .rbc-calendar {
    flex: 1 1 auto;
    min-height: 0 !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;
  }

  /* Calendar month view */
  .rbc-month-view {
    min-height: 500px !important;
    overflow: visible !important;
  }

  /* Calendar events container */
  .rbc-events-container {
    overflow: visible !important;
  }

  .rbc-row-segment {
    overflow: visible !important;
  }

  /* ==========================================
     МОДАЛЬНІ ВІКНА
     ========================================== */

  .modal-backdrop,
  [class*="modal"] {
    position: fixed !important;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    overflow: hidden !important;
    z-index: 9999;
  }

  .modal-content,
  .modal-body {
    max-height: 85vh !important;
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch !important;
    overscroll-behavior-y: contain !important;
  }

  /* ==========================================
     BOTTOM NAVIGATION FIX
     ========================================== */

  .mobile-bottom-nav,
  .bottom-navigation {
    position: fixed !important;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    background: white;
    border-top: 1px solid rgba(0,0,0,0.1);
    padding-bottom: env(safe-area-inset-bottom, 0) !important;
  }

  /* ==========================================
     HEADER FIX
     ========================================== */

  .mobile-header,
  header {
    position: sticky !important;
    top: 0;
    z-index: 100;
    background: white;
    flex-shrink: 0 !important;
  }

  /* ==========================================
     СПИСКИ ТА КАРТКИ
     ========================================== */

  .list-container,
  .cards-container,
  .grid {
    overflow-y: auto !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;
    overscroll-behavior-y: contain !important;
    padding-bottom: 20px !important;
  }

  /* ==========================================
     СПЕЦІАЛЬНІ ВИПАДКИ
     ========================================== */

  /* Sidebar/Drawer */
  .drawer,
  .sidebar,
  .mobile-menu {
    position: fixed !important;
    top: 0;
    bottom: 0;
    height: 100vh !important;
    height: 100dvh !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;
  }

  /* Tab panels */
  .tab-panel,
  [role="tabpanel"] {
    flex: 1 1 auto;
    min-height: 0 !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
  }

  /* Forms */
  form {
    overflow-y: auto !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;
  }

  /* ==========================================
     SCROLLBAR STYLING
     ========================================== */

  *::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  *::-webkit-scrollbar-track {
    background: transparent;
  }

  *::-webkit-scrollbar-thumb {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 999px;
  }

  *::-webkit-scrollbar-thumb:hover {
    background: rgba(0, 0, 0, 0.3);
  }

  /* ==========================================
     PERFORMANCE OPTIMIZATIONS
     ========================================== */

  * {
    -webkit-transform: translate3d(0, 0, 0);
    -webkit-backface-visibility: hidden;
    -webkit-perspective: 1000;
  }

  /* Prevent rubber band scrolling on iOS */
  .scroll-container {
    position: relative;
    overflow: auto;
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
  }

  /* ==========================================
     DEBUG HELPERS (видалити після тестування)
     ========================================== */

  /* Розкоментуйте для діагностики:
  main {
    border: 3px solid red !important;
  }

  .overflow-y-auto {
    border: 2px solid blue !important;
  }

  .flex-1 {
    border: 2px solid green !important;
  }
  */

}

/* ==========================================
   TABLET SPECIFIC (iPad)
   ========================================== */

@media (min-width: 768px) and (max-width: 1023px) {

  main,
  .main {
    padding-bottom: 100px !important;
    padding-bottom: calc(100px + env(safe-area-inset-bottom, 0)) !important;
  }

  .dashboard-content,
  .ubersicht-content {
    padding: 20px !important;
    padding-bottom: 120px !important;
  }

}

/* ==========================================
   SMALL PHONES
   ========================================== */

@media (max-width: 375px) {

  main,
  .main {
    padding-bottom: 70px !important;
    padding-bottom: calc(70px + env(safe-area-inset-bottom, 0)) !important;
  }

}